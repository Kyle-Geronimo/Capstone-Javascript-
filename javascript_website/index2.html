<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HotelLink</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="/image/logo/HTLogo.png">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/home-enhancements.css">
</head>
<body>
  <header>
    <div class="container">
      <h1>LinkHotel</h1>
      <nav>
        <a href="#home" class="nav-btn public-only">Home</a>
        <a href="#about" class="nav-btn public-only">About Us</a>
        <a href="#contacts" class="nav-btn public-only">Contacts</a>
        <a href="pages/login.html" class="nav-btn public-only">Login</a>
        <div class="user-nav" style="display:none;">
          <a href="#home" class="nav-btn restricted">Home</a>
          <a href="pages/chatbot.html" class="nav-btn restricted">Chatbot Data</a>
          <a href="pages/profile.html" class="nav-btn restricted">Profile</a>
          <a href="pages/admin.html" class="nav-btn restricted admin-only">Admin</a>
          <a href="pages/payroll.html" class="nav-btn restricted admin-only">Payroll</a>
          <a href="#" id="logout-btn" class="nav-btn restricted">Logout</a>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <!-- HERO / HOME SECTION -->
    <section class="home-hero" id="home">
      <div class="container hero-inner">
        <div class="hero-copy">
          <h2 style="margin-top: 3rem;">Minimalist luxury stays in Batangas City</h2>
          <p class="lead" style="margin-top: 2rem;">LinkHotel connects you with partner hotels in Kumintang Ibaba so you can enjoy seamless, comfortable stays — from check‑in to check‑out.</p>

          <div class="hero-ctas">
            <button id="login-cta" class="action-btn primary">Login</button>
            <button id="signup-cta" class="action-btn secondary">Request staff access</button>
          </div>

          <ul class="trust-features">
            <li><strong>Secure:</strong> Firebase-backed authentication</li>
            <li><strong>Fast:</strong> QR-powered check-in & quick scheduling</li>
            <li><strong>Reliable:</strong> Built for hotel staff workflows</li>
          </ul>
        </div>

        <!-- kept for decorative illustration / hero-only content; removed weather from here -->
        <aside class="hero-panel" aria-hidden="true">
          <div class="panel card">
            <img src="/image/logo/HTLogo.png" alt="" style="width:100%;max-width:320px;margin-top:12px;" />
          </div>
        </aside>
      </div>
    </section>

    <!-- ABOUT US / FEATURES GRID -->
    <section class="home-features" id="about">
      <div class="container">
        <h3 class="section-title">About LinkHotel</h3>
        <div class="features-grid">
          <div class="feature-card card">

            <svg class="feature-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2v6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><rect x="3" y="8" width="18" height="13" rx="2" stroke="currentColor" stroke-width="1.4"/></svg>
            <div>
              <h4>Effortless check‑in</h4>
              <p class="muted">Arrive and settle in faster with streamlined, front‑desk friendly workflows.</p>

            </div>
          </div>

          <div class="feature-card card">
            <svg class="feature-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M7 7h10M7 11h10M7 15h10" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <div>
              <h4>Smart assistance</h4>
              <p class="muted">Ask about room types, rates, and hotel details through our built‑in assistant.</p>

            </div>
          </div>

          <div class="feature-card card">
            <svg class="feature-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 3v7l5 2" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.4"/></svg>
            <div>
              <h4>Seamless coordination</h4>
              <p class="muted">Behind the scenes, staff tools keep your stay running smoothly.</p>

            </div>
          </div>

          <div class="feature-card card">
            <svg class="feature-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2l3 7h7l-5.5 4 2 7L12 16l-6.5 4 2-7L2 9h7z" stroke="currentColor" stroke-width="1.2" fill="none"/></svg>
            <div>
              <h4>Minimalist luxury</h4>
              <p class="muted">Clean, calming design in shades of blue inspired by Batangas waterfront views.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACTS / PARTNER HOTELS -->
    <section class="home-quicklinks" id="contacts">
      <div class="container">
        <h3 class="section-title">Our Partner Hotels</h3>
        <div class="quicklinks-row">
          <article class="quicklink card">
            <div style="display:flex;align-items:flex-start;gap:12px;">
              <img src="/image/logo/HTLogo.png" alt="D'Mariners Inn Hotel" style="width:40px;height:40px;border-radius:8px;object-fit:cover;" />
              <div>
                <strong>D'Mariners Inn Hotel</strong>
                <p class="muted">Arceo Rd, Kumintang Ibaba, Batangas City, Philippines</p>
                <p class="muted">Phone: 0917 623 0544</p>
                <p class="muted">Email: dmarinersinnhotel@yahoo.com</p>
              </div>
            </div>
          </article>

          <article class="quicklink card">
            <div style="display:flex;align-items:flex-start;gap:12px;">
              <img src="/image/logo/HTLogo.png" alt="Wennrod Hotel" style="width:40px;height:40px;border-radius:8px;object-fit:cover;" />
              <div>
                <strong>Wennrod Hotel</strong>
                <p class="muted">Governor Carpio Road, Kumintang Ibaba, Batangas City, Philippines</p>
                <p class="muted">Phone: 0917 156 5098</p>
                <p class="muted">Email: wennrodhotel28@gmail.com</p>
              </div>
            </div>
          </article>

          <article class="quicklink card">
            <div style="display:flex;align-items:flex-start;gap:12px;">
              <img src="/image/logo/HTLogo.png" alt="Bicotels Hotel" style="width:40px;height:40px;border-radius:8px;object-fit:cover;" />
              <div>
                <strong>Bicotels Hotel</strong>
                <p class="muted">At the back of SAWALI Resto, Bagui St. Kumintang Ibaba, Batangas City, Philippines</p>
                <p class="muted">Phone: 0917 627 3442</p>
                <p class="muted">Email: bicotelshotel@gmail.com</p>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- LOGIN SHORTCUTS (STAFF / ADMIN ENTRY) -->
    <section class="home-quicklinks" id="login">
      <div class="container">
        <div class="quicklinks-row">

          <a class="quicklink card" href="pages/login.html">
            <strong>Sign In</strong>
            <span class="muted">Access staff portal</span>
          </a>
          <a class="quicklink card" href="pages/signup.html">
            <strong>Create account</strong>
            <span class="muted">Request access</span>
          </a>
          <a class="quicklink card restricted admin-only" href="pages/admin.html" style="display:none;">
            <strong>Admin</strong>
            <span class="muted">Manage users & settings</span>
          </a>
        </div>
      </div>
    </section>

    <!-- Floating Chat Widget (now powered by in-app chatbot) -->
    <div class="chat-widget" aria-live="polite">
      <div class="chat-widget-panel" id="chat-widget-panel">
        <div class="chat-widget-header">
          <div class="chat-widget-title">
            <img src="/image/logo/HTLogo.png" alt="HotelLink chat" class="chat-widget-title-logo" />
            <div>
              <strong>Chat with HotelLink</strong>
              <span class="chat-widget-subtitle">Ask about rooms, rates, or hotel info</span>
            </div>
          </div>
          <button type="button" id="chat-widget-close" class="chat-widget-close" aria-label="Close chat">&times;</button>
        </div>
        <div class="chat-widget-body">
          <div class="chat-widget-messages" id="chat-messages">
            <div class="chat-message chat-message-bot">
              <div class="chat-bubble">
                Hi, I’m the HotelLink assistant. You can ask me about room types, availability, pricing, or hotel policies.
              </div>
            </div>
          </div>
          <form class="chat-widget-input-row" id="chat-form" autocomplete="off">
            <input
              type="text"
              id="chat-input"
              class="chat-input"
              name="message"
              placeholder="Type your question here..."
              aria-label="Type your question for HotelLink assistant"
              required
            />
            <button type="submit" id="chat-send-btn" class="chat-send-btn">Send</button>
          </form>
          <p class="chat-widget-hint">Powered by HotelLink AI (Gemini + Firestore)</p>
        </div>
      </div>

      <button
        type="button"
        id="chat-widget-toggle"
        class="chat-widget-button"
        aria-label="Open chat with HotelLink"
      >
        <img src="/image/logo/HTLogo.png" alt="Chat with HotelLink" />
      </button>
    </div>

  </main>

  <footer>
    <div class="container">
      <p style="text-align: center;">&copy; 2025 D’ Mariners Inn Hotel. All rights reserved.</p>
    </div>
  </footer>

  <!-- keep existing modules -->
  <script type="module" src="./js/qr.js"></script>
  <script type="module" src="./js/auth.js"></script>

  <script type="module">
    import { auth } from './js/firebase-config.js';
    import { updateNavVisibility, highlightActiveNavBtn } from './js/nav-control.js';
    import { initializeWeatherCards } from './js/weather.js';
    import { logout } from './js/auth.js';

    // --- NEW: Scroll Animation Initializer ---
    const initScrollAnimations = () => {
      // Elements we want to animate on scroll
      const observerElements = [
        // Hero Content (we target the parent and apply visibility to children via CSS)
        document.querySelector('.hero-copy'),
        document.querySelector('.hero-panel'),
        // Feature Cards
        ...document.querySelectorAll('.features-grid .feature-card'),
        // Quick Links
        ...document.querySelectorAll('.quicklinks-row .quicklink')
      ].filter(el => el != null); // Filter out any null elements

      const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            // Element is now in view
            entry.target.classList.add('is-visible');
            // Stop observing once it has been animated
            observer.unobserve(entry.target);
          }
        });
      }, {
        // Options for the observer: start animating when 10% of element is visible
        threshold: 0.1 
      });

      observerElements.forEach(el => observer.observe(el));
    };
    // --- END NEW FUNCTION ---

    // Function to handle visibility of all public-facing elements (from previous step)
    const updatePublicContentVisibility = (user) => {
      // ... (Rest of the previous logic for hiding login/signup links) ...
      const publicNavElements = document.querySelectorAll('.nav-btn.public-only');
      const heroCtas = document.querySelector('.hero-ctas');
      const quicklinks = document.querySelector('.quicklinks-row');
      
      if (user) {
        publicNavElements.forEach(el => el.style.display = 'none');
        if (heroCtas) heroCtas.style.display = 'none';
        
        const publicQuicklinks = quicklinks.querySelectorAll('a:not(.restricted)');
        publicQuicklinks.forEach(el => el.style.display = 'none');
        
      } else {
        publicNavElements.forEach(el => el.style.display = '');
        if (heroCtas) heroCtas.style.display = 'flex';
        
        const publicQuicklinks = quicklinks.querySelectorAll('a:not(.restricted)');
        publicQuicklinks.forEach(el => el.style.display = 'flex');
      }
    };
    // --- END PREVIOUS LOGIC ---

    // Initial load checks
    updateNavVisibility();
    highlightActiveNavBtn();
    
    // Run the new animation function
    initScrollAnimations();

    auth.onAuthStateChanged((user) => {
      updateNavVisibility();
      highlightActiveNavBtn();
      updatePublicContentVisibility(user);

      // On staff home (index2), remove public-only nav buttons once user   is logged in
      if (user) {
        const publicNavLinks = document.querySelectorAll('nav .nav-btn.public-only');
        publicNavLinks.forEach(link => link.remove());
      }
    });

    document.getElementById('login-cta').addEventListener('click', () => window.location.href = 'pages/login.html');
    document.getElementById('signup-cta').addEventListener('click', () => window.location.href = 'pages/signup.html');

    const logoutBtn = document.getElementById('logout-btn');
    if (logoutBtn) {
      logoutBtn.addEventListener('click', async (e) => {
        e.preventDefault();
        try { await logout(); } catch (err) { console.error('Logout failed:', err); }
      });
    }

    // Floating chat widget behavior
    const chatWidgetToggle = document.getElementById('chat-widget-toggle');
    const chatWidgetPanel = document.getElementById('chat-widget-panel');
    const chatWidgetClose = document.getElementById('chat-widget-close');
    const chatMessages = document.getElementById('chat-messages');
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');

    const openChatPanel = () => {
      if (!chatWidgetPanel) return;
      chatWidgetPanel.classList.add('is-open');
      if (chatInput) chatInput.focus();
    };

    const closeChatPanel = () => {
      if (!chatWidgetPanel) return;
      chatWidgetPanel.classList.remove('is-open');
    };

    if (chatWidgetToggle) {
      chatWidgetToggle.addEventListener('click', () => {
        if (chatWidgetPanel?.classList.contains('is-open')) {
          closeChatPanel();
        } else {
          openChatPanel();
        }
      });
    }

    if (chatWidgetClose) {
      chatWidgetClose.addEventListener('click', () => {
        closeChatPanel();
      });
    }

    const appendMessage = (text, from = 'bot') => {
      if (!chatMessages) return;
      const wrapper = document.createElement('div');
      wrapper.className = `chat-message chat-message-${from}`;
      const bubble = document.createElement('div');
      bubble.className = 'chat-bubble';
      bubble.textContent = text;
      wrapper.appendChild(bubble);
      chatMessages.appendChild(wrapper);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    };

    const CHAT_API_BASE = window.API_BASE || 'http://localhost:4000';

    const sendToChatbot = async (message) => {
      try {
        const res = await fetch(`${CHAT_API_BASE}/chat`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message })
        });

        if (!res.ok) {
          throw new Error(`Chatbot error: ${res.status}`);
        }

        const data = await res.json();
        const reply = (data && (data.reply || data.response || data.message)) || '';
        appendMessage(reply || "I'm having trouble answering right now. Please try again in a moment.", 'bot');
      } catch (err) {
        console.error('Chatbot request failed:', err);
        appendMessage("Sorry, I couldn't reach the assistant. Please try again later.", 'bot');
      }
    };

    if (chatForm && chatInput) {
      chatForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const value = chatInput.value.trim();
        if (!value) return;
        appendMessage(value, 'user');
        chatInput.value = '';
        sendToChatbot(value);
      });
    }
  </script>
</body>
</html>
