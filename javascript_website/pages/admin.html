<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HotelLink - Admin</title>
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://www.gstatic.com/firebasejs/12.4.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.4.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore-compat.js"></script>

  <script type="module" src="../js/firebase-config.js"></script>
  <script type="module" src="../js/auth.js"></script>
  <script type="module" src="../js/admin.js"></script>
</head>
<body>
  <header>
    <div class="container">
      <h1>HotelLink</h1>
      <nav>
        <a href="../index.html" class="nav-btn">Home</a>
        <a href="chatbot.html" class="nav-btn restricted">Chatbot Data</a>
        <a href="admin.html" class="nav-btn restricted admin-only">Admin</a>
        <a href="payroll.html" class="nav-btn restricted admin-only">Payroll</a>
        <a href="profile.html" class="nav-btn restricted">Profile</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="form-container chatbot-data-container admin-dashboard">
      <h2>Dashboard</h2>

      <!-- Account Requests Section -->
      <div class="admin-section">
        <h3>Account Requests</h3>
        <div class="requests-panel">
          <div id="requests" class="request-list">
            <em>Loading requests…</em>
          </div>
        </div>
      </div>

      <!-- User Management Section -->
      <!-- Payroll View Requests panel (admins) -->
      <div id="payroll-requests-wrapper" style="display:flex;flex-direction:column;gap:8px; margin-top:12px;">
        <div id="payroll-requests-panel" class="requests-panel profile-card" style="width:360px;min-width:280px;max-height:78vh;overflow:auto;padding:12px;border-radius:8px;">
          <h3 style="margin:0 0 8px 0;">Payroll View Requests</h3>
          <div id="payrollRequestsList">Loading payroll view requests...</div>
        </div>
      </div>
      <div class="admin-section">
        <div class="section-header">
          <h3>User Management</h3>
          <a href="archives.html" class="action-btn">Archives</a>
        </div>
        <div class="accounts-panel">
          <div id="accounts" class="accounts-list">
            <em>Loading accounts…</em>
          </div>
        </div>
      </div>

    </section>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 D' Mariners Inn Hotel. All rights reserved.</p>
    </div>
  </footer>
  
  <script type="module">
    import { auth } from '../js/firebase-config.js';
    import { updateNavVisibility, highlightActiveNavBtn } from '../js/nav-control.js';
    import { watchRequestsRealtime, loadAccounts } from '../js/admin.js';
    updateNavVisibility();
    highlightActiveNavBtn();
    
    auth.onAuthStateChanged((user) => {
      updateNavVisibility();
      highlightActiveNavBtn();
      if (user) {
        watchRequestsRealtime(); 
        loadAccounts(); 
      }
    });
  </script>
</body>
</html>
