<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Forgot password</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{font-family:Arial, sans-serif;padding:24px}
    input,button{padding:8px;margin:6px 0;border:1px solid #ccc;border-radius:6px}
    button.primary{background:#2563eb;color:#fff;border:none;padding:8px 12px}
    .muted{color:#666}
    .error{color:#b91c1c}
    .success{color:#16a34a}
  </style>
</head>
<body>
  <h2>Forgot password</h2>
  <p class="muted">Enter your account email and we'll send a password reset link.</p>

  <form id="form">
    <input id="email" type="email" placeholder="you@example.com" required style="width:320px"/><br/>
    <button class="primary" type="submit">Send Reset Email</button>
  </form>

  <div id="message" class="muted" style="margin-top:12px"></div>

 <script type="module">
  // correct path from pages/forgot-password.html to js/firebase-config.js
  import { auth } from '../js/firebase-config.js';
  import { sendPasswordResetEmail } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';

  const form = document.getElementById('form');
  const msg = document.getElementById('message');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('email').value.trim();
    if (!email) return alert('Enter email');

    msg.textContent = 'Sending reset emailâ€¦';
    msg.className = 'muted';

    try {
      // modular usage: sendPasswordResetEmail(auth, email)
      await sendPasswordResetEmail(auth, email);
      msg.textContent = 'If an account exists for that email, a reset link was sent.';
      msg.className = 'success';
    } catch (err) {
      console.error('sendPasswordResetEmail error', err);
      // Friendly messages: don't leak existence
      if (err.code === 'auth/invalid-email') {
        msg.textContent = 'That email address looks invalid.';
        msg.className = 'error';
      } else if (err.code === 'auth/user-not-found') {
        msg.textContent = 'If an account exists for that email, a reset link was sent.';
        msg.className = 'muted';
      } else {
        msg.textContent = 'Error sending reset email. See console for details.';
        msg.className = 'error';
      }
    }
  });
</script>
</body>
</html>
