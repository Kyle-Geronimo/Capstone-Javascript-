<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HotelLink - Reset Password</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="../image/logo/HTLogo.png">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <header>
    <div class="container">
      <h1>HotelLink</h1>
    </div>
  </header>

  <main>
    <section class="auth-page reset-page">
      <div class="form-container">
        <h2>Forgot your password?</h2>
        <p class="reset-password-subtitle">No worries, we'll help you reset it.</p>

        <div class="reset-password-info">
          <p style="color: #666; font-size: 0.95rem;">Enter your account email and we'll send a password reset link. Check your inbox and follow the instructions to create a new password.</p>
        </div>

        <form id="form" class="reset-password-form">
          <label for="email">Email Address</label>
          <input id="email" type="email" placeholder="Enter your email address" required />
          <button class="action-btn primary" type="submit">Send Reset Email</button>
          <div id="message" class="message-box"></div>
        </form>

        <div class="reset-password-footer">
          <p class="text-center">Remember your password? <a href="login.html" class="link-btn">Back to login</a></p>
        </div>

        <div class="reset-password-help">
          <h4 style="margin-top: 2rem; color: #1f4ea6;">Need help?</h4>
          <ul class="help-list" style="margin-left: 1.5rem; color: #666; font-size: 0.9rem;">
            <li>Check your spam folder if you don't see the email</li>
            <li>Make sure you're using the correct email address</li>
            <li>Try again in a few minutes if you don't receive it</li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 D' Mariners Inn Hotel. All rights reserved.</p>
    </div>
  </footer>

  <script type="module">
    import { auth } from '../js/firebase-config.js';
    import { sendPasswordResetEmail } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';

    const form = document.getElementById('form');
    const msg = document.getElementById('message');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value.trim();
      if (!email) return alert('Enter email');

      const btn = form.querySelector('button[type="submit"]');
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Sendingâ€¦';

      msg.textContent = '';
      msg.className = '';

      try {
        await sendPasswordResetEmail(auth, email);
        msg.textContent = 'If an account exists for that email, a reset link was sent.';
        msg.className = 'success-message';
      } catch (err) {
        console.error('sendPasswordResetEmail error', err);
        if (err.code === 'auth/invalid-email') {
          msg.textContent = 'That email address looks invalid.';
          msg.className = 'error-message';
        } else if (err.code === 'auth/user-not-found') {
          msg.textContent = 'If an account exists for that email, a reset link was sent.';
          msg.className = 'success-message';
        } else {
          msg.textContent = 'Error sending reset email. See console for details.';
          msg.className = 'error-message';
        }
      } finally {
        btn.disabled = false;
        btn.textContent = originalText;
      }
    });
  </script>
</body>
</html>